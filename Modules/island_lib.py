# -*- coding: utf-8 -*-
"""
Created on Mon Aug 29 18:58:40 2022

@author: lukas & anders
"""

#%% Sound
def play_sound():
    #Play sound. Used when calculations finish.
    import winsound
    winsound.Beep(294, 800)
    winsound.Beep(311, 300)
    winsound.Beep(233, 800)
    
def play_mario():
    import winsound
    import time
    winsound.Beep(659, 125)
    winsound.Beep(659, 125)
    time.sleep(0.125)
    winsound.Beep(659, 125)
    time.sleep(0.167)
    winsound.Beep(523, 125)
    winsound.Beep(659, 125)
    time.sleep(0.125)
    winsound.Beep(784, 125)
    time.sleep(0.375)
    winsound.Beep(392, 125)
    time.sleep(0.375)
    winsound.Beep(523, 125)
    time.sleep(0.250)
    winsound.Beep(392, 125)
    time.sleep(0.250)
    winsound.Beep(330, 125)
    time.sleep(0.250)
    winsound.Beep(440, 125)
    time.sleep(0.125)
    winsound.Beep(494, 125)
    time.sleep(0.125)
    winsound.Beep(466, 125)
    time.sleep(0.42)
    winsound.Beep(440, 125)
    time.sleep(0.125)
    winsound.Beep(392, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.125)
    # winsound.Beep(784, 125)
    # time.sleep(0.125)
    # winsound.Beep(880, 125)
    # time.sleep(0.125)
    # winsound.Beep(698, 125)
    # winsound.Beep(784, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(587, 125)
    # winsound.Beep(494, 125)
    # time.sleep(0.125)
    # winsound.Beep(523, 125)
    # time.sleep(0.250)
    # winsound.Beep(392, 125)
    # time.sleep(0.250)
    # winsound.Beep(330, 125)
    # time.sleep(0.250)
    # winsound.Beep(440, 125)
    # time.sleep(0.125)
    # winsound.Beep(494, 125)
    # time.sleep(0.125)
    # winsound.Beep(466, 125)
    # time.sleep(0.42)
    # winsound.Beep(440, 125)
    # time.sleep(0.125)
    # winsound.Beep(392, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.125)
    # winsound.Beep(784, 125)
    # time.sleep(0.125)
    # winsound.Beep(880, 125)
    # time.sleep(0.125)
    # winsound.Beep(698, 125)
    # winsound.Beep(784, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(587, 125)
    # winsound.Beep(494, 125)
    # time.sleep(0.375)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(415, 125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(698, 125)
    # time.sleep(0.125)
    # winsound.Beep(698, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.625)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(415, 125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(622, 125)
    # time.sleep(0.250)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(523, 125)
    # time.sleep(0.1125)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(415, 125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(698, 125)
    # time.sleep(0.125)
    # winsound.Beep(698, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.625)
    # winsound.Beep(784, 125)
    # winsound.Beep(740, 125)
    # winsound.Beep(698, 125)
    # time.sleep(0.42)
    # winsound.Beep(622, 125)
    # time.sleep(0.125)
    # winsound.Beep(659, 125)
    # time.sleep(0.167)
    # winsound.Beep(415, 125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # time.sleep(0.125)
    # winsound.Beep(440, 125)
    # winsound.Beep(523, 125)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(622, 125)
    # time.sleep(0.250)
    # winsound.Beep(587, 125)
    # time.sleep(0.250)
    # winsound.Beep(523, 125)
    print("Song finished")

#%% Get country Data
def get_load_and_price(year): # require year
    import pandas as pd
    
    cprice = pd.read_csv('https://github.com/TheReal-Andrew/NorthSeaEnergyIsland/blob/main/Data/market/price_%d.csv?raw=true'%year, index_col = 0)      
    cload = pd.read_csv('https://github.com/TheReal-Andrew/NorthSeaEnergyIsland/blob/main/Data/market/load_%d.csv?raw=true'%year, index_col = 0)
    
    return cprice, cload

#%% Annuity
def get_annuity(i, n):
    annuity = i/(1.-1./(1.+i)**n)
    return annuity

#%% Remove outliers
def remove_outliers(df,columns,n_std):
    for col in columns:
        print('Working on column: {}'.format(col))
        
        mean = df[col].mean()
        sd = df[col].std()
        
        df = df[(df[col] <= mean+(n_std*sd))]
        
    return df

def earth_distance(lat1,lat2,lon1,lon2):
    import numpy as np
    R = 6378.1  #Earths radius
    dlon = (lon2 - lon1) * np.pi/180
    dlat = (lat2 - lat1) * np.pi/180
    
    lat1 = lat1 * np.pi/180
    lat2 = lat2 * np.pi/180
    
    a = (np.sin(dlat/2))**2 + np.cos(lat1) * np.cos(lat2) * (np.sin(dlon/2))**2
    c = 2 * np.arctan2(np.sqrt(a), np.sqrt(1-a)) 
    d = R*c #Spherical distance between two points
    
    return d